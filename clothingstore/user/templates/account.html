{% extends "base.html" %}
{% load static %}
{% block title %}My Company Account{% endblock %} {# Updated title #}

{% block content %}
<div class="bg-[#f9f9f9] min-h-screen py-10 px-4 font-[Montserrat]">

  <div class="max-w-5xl mx-auto mb-8">
    <h1 class="text-3xl font-semibold tracking-tight mb-1 text-gray-900">My Clauch Company Account</h1> {# Updated header #}
    <p class="text-gray-500 text-sm">
      Welcome back, <span class="font-medium text-gray-800">{{ user.full_name }}</span> (Contact for {{ user.company_name|default:"Your Company" }}) {# Added company context #}
    </p>
  </div>

  <div class="max-w-5xl mx-auto grid md:grid-cols-3 gap-5">

    <div class="bg-white shadow-sm rounded-lg p-4 text-sm space-y-2">
      <h2 class="text-base font-semibold mb-3 text-gray-900">Company Account Details</h2> {# Updated section title #}

      {% if edit_mode %}
      <form method="POST" action="{% url 'update_profile' %}" class="space-y-4">
        {% csrf_token %}

        {# Contact Person Details #}
        <h3 class="font-semibold text-gray-800 mt-4 mb-2">Contact Person Info</h3>
        <div>
          <label for="full_name" class="text-gray-600 text-sm">Full Name</label>
          <input type="text" id="full_name" name="full_name" value="{{ user.full_name|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label for="email" class="text-gray-600 text-sm">Email</label>
          <input type="email" id="email" name="email" value="{{ user.email|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label class="text-gray-600 text-sm">Phone Number</label>
          <p class="mt-1 font-medium text-sm text-gray-800">+91 {{ user.phone_number }}</p>
          <p class="text-xs text-gray-400 mt-1">Phone number cannot be changed here.</p> {# Usually phone is primary ID #}
        </div>

        {# Company/Billing Details #}
        <h3 class="font-semibold text-gray-800 mt-4 mb-2">Company Information</h3>
        <div>
          <label for="company_name" class="text-gray-600 text-sm">Company Name</label>
          <input type="text" id="company_name" name="company_name" value="{{ user.company_name|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label for="gst_number" class="text-gray-600 text-sm">GSTIN</label>
          <input type="text" id="gst_number" name="gst_number" value="{{ user.gst_number|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
          <p class="text-xs text-gray-400 mt-1">Required for B2B invoicing.</p>
        </div>

        {# Address Details #}
        <h3 class="font-semibold text-gray-800 mt-4 mb-2">Billing Address</h3>
        <div>
          <label for="address" class="text-gray-600 text-sm">Street Address</label>
          <textarea id="address" name="address"
                    class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition h-20">{{ user.address|default:'' }}</textarea>
        </div>
        <div>
          <label for="city" class="text-gray-600 text-sm">City</label>
          <input type="text" id="city" name="city" value="{{ user.city|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label for="state" class="text-gray-600 text-sm">State</label>
          <input type="text" id="state" name="state" value="{{ user.state|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label for="zip_code" class="text-gray-600 text-sm">Zip/Postal Code</label>
          <input type="text" id="zip_code" name="zip_code" value="{{ user.zip_code|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>
        <div>
          <label for="country" class="text-gray-600 text-sm">Country</label>
          <input type="text" id="country" name="country" value="{{ user.country|default:'' }}"
                 class="w-full mt-1 border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-black transition">
        </div>

        <div class="flex gap-2 mt-6">
          <button type="submit"
                  class="w-full py-2 bg-black text-white text-sm font-medium rounded hover:bg-gray-900 transition">
            Save Changes
          </button>
          <a href="{% url 'account' %}" class="w-full py-2 text-center border border-gray-300 text-sm font-medium rounded hover:bg-gray-50 transition">
            Cancel
          </a>
        </div>
      </form>
      {% else %}
      <h3 class="font-semibold text-gray-800 mb-2">Contact Person Info</h3>
      <p><span class="text-gray-500">Full Name:</span> {{ user.full_name|default:'N/A' }}</p>
      <p><span class="text-gray-500">Email:</span> {{ user.email|default:'N/A' }}</p>
      <p><span class="text-gray-500">Phone:</span> +91 {{ user.phone_number|default:'N/A' }}</p>

      <h3 class="font-semibold text-gray-800 mt-4 mb-2">Company Information</h3>
      <p><span class="text-gray-500">Company Name:</span> {{ user.company_name|default:'N/A' }}</p>
      <p><span class="text-gray-500">GSTIN:</span> {{ user.gst_number|default:'N/A' }}</p>

      <h3 class="font-semibold text-gray-800 mt-4 mb-2">Billing Address</h3>
      {% if user.address or user.city or user.state or user.zip_code or user.country %}
        <address class="not-italic text-gray-800">
          {{ user.address|default:'' }}<br>
          {% if user.city %}{{ user.city }}{% endif %}{% if user.zip_code %}, {{ user.zip_code }}{% endif %}<br>
          {% if user.state %}{{ user.state }}{% endif %}{% if user.country %}, {{ user.country }}{% endif %}
        </address>
      {% else %}
        <p class="text-gray-500">No address details provided.</p>
      {% endif %}
      {% endif %}
    </div>

    <div class="md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">

      {% if not edit_mode %}
      <a href="{% url 'account' %}?edit=true"
         class="group flex items-center gap-3 bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition">
        <svg class="w-5 h-5 text-gray-500 group-hover:text-black" fill="none" stroke="currentColor" stroke-width="1.5"
             viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M16.862 3.487a2.3 2.3 0 013.25 3.25L7.5 19.348 3 21l1.652-4.5L16.862 3.487z"/>
        </svg>
        <span class="text-sm font-medium text-gray-800 group-hover:text-black">Edit Account Details</span> {# Updated text #}
      </a>
      {% endif %}

      <a href="{% url 'my_orders' %}" class="group flex items-center gap-3 bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition">
        <svg class="w-5 h-5 text-gray-500 group-hover:text-black" fill="none" stroke="currentColor" stroke-width="1.5"
             viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 3h18v18H3V3zm3 6h12M9 12h6m-6 3h6"/>
        </svg>
        <span class="text-sm font-medium text-gray-800 group-hover:text-black">Company Order History</span> {# Updated text #}
      </a>


      <a href="{% url 'view_cart' %}" class="group flex items-center gap-3 bg-white rounded-lg shadow-sm p-4 hover:shadow-md transition">
        <svg class="w-5 h-5 text-gray-500 group-hover:text-black" fill="none" stroke="currentColor" stroke-width="1.5"
             viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2 9m11-9v9m-4-9v9"/>
        </svg>
        <span class="text-sm font-medium text-gray-800 group-hover:text-black">Go to Quote Cart</span> {# Updated text #}
      </a>

      {# --- Additional Company-Specific Actions (Icons are placeholders) --- #}





    </div>
  </div>

  <div class="max-w-5xl mx-auto mt-10">
    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit"
              class="px-4 py-2 text-sm bg-black text-white font-medium rounded hover:bg-gray-900 transition">
        Sign Out
      </button>
    </form>
  </div>

</div>
{% endblock %}